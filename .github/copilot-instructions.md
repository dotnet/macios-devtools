---
description: 'Guidelines for C# library work'
applyTo: '**/*.cs'
---

# C# Development

## Project-Specific Context

This repository hosts **Xamarin.MacDev**, a .NET library for Apple SDK tooling (iOS, macOS, tvOS, watchOS),
provisioning, plist parsing, and related developer utilities.

- Target frameworks: `netstandard2.0` and `net10.0`
- C# Language Version: `latest` (per project files)
- Nullable reference types are enabled
- SDK-style projects built with `dotnet build` (or `make`)
- Tests: `tests` project using **NUnit**

## Guidance

- Follow existing conventions and `.editorconfig`.
- Keep changes minimal and reuse existing helpers.
- Avoid APIs that are unavailable in `netstandard2.0` when used in shared code.
- Do not edit auto-generated files (`// <auto-generated>` or `*.g.cs`).

## Code Style

- Use tabs for indentation (size 4).
- Use `namespace Xamarin.MacDev {` (brace on same line) with a **blank line after the opening brace**.
- One class per file.
- Keep classes under ~700 lines; extract helpers/parsers into separate files when needed.
- Private/internal fields: `camelCase`. Types/methods/properties: `PascalCase`.
- Space before method call parentheses: `Method ()`, not `Method()`.
- License header on new files: `// Copyright (c) Microsoft Corporation.` / `// Licensed under the MIT License.`
- Add `#nullable enable` at the top of new files.

## Error Handling

- Validate inputs at public boundaries using `ArgumentNullException.ThrowIfNull` and `string.IsNullOrWhiteSpace`.
- Use precise exception types and avoid catch-and-swallow patterns.
- Catch specific exceptions (`catch (UnauthorizedAccessException)`) — never bare `catch (Exception)`.

## Resource Management

- Use `using` on **all** disposables — including `StringWriter`, `Process`, `StreamReader`, etc.
- Prefer the Null Object Pattern (e.g. `static readonly NullProgress`) over null-checking everywhere.

## .NET SDK Patterns

- Prefer `Path.GetRandomFileName()` for temp file names.
- Use `File.Create(path, bufferSize, FileOptions.DeleteOnClose)` when appropriate for transient files.

## Documentation

- Mirror existing documentation style; add comments only when they clarify intent or public APIs require it.

## Testing

- Use NUnit for new or changed tests and follow existing naming patterns.
- Every new utility method **must** have test coverage — no exceptions.
